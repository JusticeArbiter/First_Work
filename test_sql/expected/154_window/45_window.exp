SELECT four, ten,  sum(ten) over (partition by four order by ten range between unbounded preceding and current row),  last_value(ten) over (partition by four order by ten range between unbounded preceding and current row)  FROM (select distinct ten, four from tenk1) ss;
 four | ten | sum | last_value 
------+-----+-----+------------
(0 rows)

