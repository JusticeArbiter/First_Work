select f1, ss1 as relabel from  (select *, (select sum(f1) from int4_tbl b where f1 >= a.f1) as ss1  from int4_tbl a) ss;
     f1      |  relabel   
-------------+------------
           0 | 2147607103
      123456 | 2147607103
     -123456 | 2147483647
  2147483647 | 2147483647
 -2147483647 |          0
(5 rows)

